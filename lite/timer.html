<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="UTF-8" />
    <title>NRAO Timer</title>
    <script language="JavaScript">
    var ticks=0; var mins=0; var secs=0;
    var counter; var timeStr; var talkPart=0;
    var qaTime;
    var talkLen; var seconds=0;
    function userTimer(F) {
    	startTimer(F.userTalk.value*60, F.userQA.value*60);
    }
    function startTimer(talkSecs, qaSecs) {
	if (talkSecs>0) {
	    talkLen=talkSecs+qaSecs
	    seconds=0;
	    document.getElementById("mode").innerHTML="Presentation";
	    ticks=talkSecs;
	    talkPart=1;
	    if (qaSecs>0) {
		qaTime=qaSecs;
	    }
	} else {
	    if (qaSecs>0) {
		document.getElementById("mode").innerHTML="Question / Answer";
		talkPart=2;
		ticks=qaSecs;
	    }
	}
	updateDisplay();
	document.getElementById('gui').style.visibility='hidden';
	document.getElementById('timer').style.color='white';
	document.getElementById("timer").style.fontSize="17em";
	counter=setInterval(timerFunc, 1000);
    }
    function updateDisplay() {
	var elem=document.getElementById("timer");
    	mins=Math.floor(ticks/60);
	secs=ticks-(mins*60);
	if(secs.toString().length<2) { secs='0'+secs; }
	elem.innerHTML=mins +":" +secs;
	divlen=document.getElementById('progress').clientWidth;
	barlen=Math.ceil(seconds/talkLen*divlen);
	document.getElementById('bar').style.width=barlen+'px';
    }
    function timerFunc() {
	ticks=ticks-1;
	seconds=seconds+1;
	if (ticks <=0 ) {
	    var x=document.getElementById('autoQA');
	    if (talkPart==1 && x.checked) {
		talkPart=2;
		ticks=qaTime;   updateDisplay();
		document.getElementById("mode").innerHTML="Question / Answer";
	    } else {
		updateDisplay();
		clearInterval(counter);
		var elem=document.getElementById("timer")
		elem.style.fontSize="10em";
		elem.innerHTML="Your time has expired!";
		document.getElementById("mode").innerHTML="";
		counter=setInterval(timeIsUp, 700);
	    }
	} else {
	    updateDisplay();
	}
    }
    function showGui() {
	document.getElementById('timer').style.color='white';
	document.getElementById("gui").style.visibility='visible';
	clearInterval(counter);
    }
    function timeIsUp() {
    	var elem=document.getElementById("timer");
	if (elem.style.color=="white") {
	    elem.style.color = "red";
	} else {
	    elem.style.color = "white";
	}
    }
    
    </script>
    <style>
	body { background-color: #000; color: #fff; }
	#mode { text-align: center; height: 100px; font-size: 5em; }
        #timer { height: 370px; font-size: 17em; text-align: center;}
	#gui { height: 80px; }
	#progress { margin-left: auto;
		margin-right: auto; width: 70%;
		border: 1px solid #fff; height:20px;
		background-color: #2f2; }
	#bar { background-color: #f33; height: 20px; width: 0%; }
    </style>
  </head>
  <body onLoad="updateDisplay()">
    <div id="mode"></div>
    <div id="timer" onClick="showGui()">
    </div>
    <div id="progress"><div id="bar"></div></div>
    <div id="gui">
      <table class="guiTable">
         <tr>
	    <td>
		<button onClick="startTimer(60,60)">1 / 1</button>
		<button onClick="startTimer(15*60,5*60)">Normal talk<br/>15 / 5</button>
		<button onClick="startTimer(35*60,5*60)">Invited talk<br/>35 / 5</button>
		<button onClick="startTimer(10,10)">Quick test<br/>:10 / :10</button>
		<br/><br/>
		<b>Custom timer: </b> &nbsp;
		<form name="usertime">
		<input type="text" size="2" name="userTalk"> / <input type="text" size="2" name="userQA">
		&nbsp;
		<input type="button" value="Custom countdown" onClick="userTimer(this.form)">
		</form>
		<br/>
		<button onClick="startTimer(0,0)">Resume countdown</button>
	    </td><td>
		<form name="qaMode">
	        <input type="checkbox" id="autoQA" checked="checked" value="1">Auto-advance to Q/A
		</form>
	    </td>
	</tr>
      </table>
    </div>
    
  </body>
</html>

